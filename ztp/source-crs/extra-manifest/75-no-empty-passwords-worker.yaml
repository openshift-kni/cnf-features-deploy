apiVersion: machineconfiguration.openshift.io/v1
kind: MachineConfig
metadata:
  labels:
    machineconfiguration.openshift.io/role: worker
  name: 75-worker-no-empty-passwords
spec:
  config:
    ignition:
      version: 2.2.0
    systemd:
      units:
        - contents: |
            [Unit]
            Description=Prevent Login to Accounts With Empty Password
            [Service]
            Type=oneshot
            RemainAfterExit=yes
            ExecStart=sed -i 's/nullok//g' /etc/pam.d/system-auth /etc/pam.d/password-auth

            [Install]
            WantedBy=multi-user.target
          enabled: true
          name: no-empty-passwords.service
